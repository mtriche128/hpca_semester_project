# The HPCA Semester Project

## Overview

This is the HPCA semester project for Mike Morgan and Matthew Triche.

## Getting Started

### Background

All libraries and scripts compiled and processed by the project's build system are installed to and ran from within the project's directory structure without needing define special environment variables. This project is intended to be portable as possible. To achieve this, cmake was leveraged and forms the backbone of the project's build system.

### Pre-Reqs

* cmake (>= v3.2)
* python2.7
* numpy
* matplotlib

The PYNQ board's SD card image should come with all nessessary pre-reqs installed.

### Setup for the PYNQ Board

These directions assume your PYNQ board is connected to a host PC using a static IP connection.

#### Step (1) Clone the Git Repo

To retrieve the latest project files, simply clone the git repo on the host PC.

```
$ git clone https://github.com/mtriche128/hpca_semester_project.git
```

#### Step (2) Package the Project Files

To make uploading project files onto the PYNQ board easier, a packaging tool can be used which compresses all nessessary files and directories into a tarball. From the project's root directory, run the 'package' utility.

```
$ cd hpca_semester_project
$ bin/package
```
A file called 'hpca_semester_project.tar.gz' should have been generated in the project's root directory. 

#### Step (3) Upload Project to the PQYNQ Board

Connect to the PYNQ board using sftp. The account and IP address should be xilinx@192.168.2.99 (password is xilinx)
Once that is done, upload 'hpca_semester_project.tar.gz'.

```
$ sftp xilinx@192.168.2.99
xilinx@192.168.2.99's password: 
Connected to 192.168.2.99.
sftp> put hpca_semester_project.tar.gz 
Uploading hpca_semester_project.tar.gz to /home/xilinx/hpca_semester_project.tar.gz
hpca_semester_project.tar.gz                                                                                                                                 100%   50KB  50.0KB/s   00:00
sftp> exit
```

#### Step (4) Unpackage the Project

Connect to the PYNQ board over SSH. The account and IP addressed should be xilinx@192.168.2.99 (password is xilinx)
Once connected to the PYNQ board over SSH, extract all file from the tarball into the 'jupyter_notebooks' directory.

```
$ ssh xilinx@192.168.2.99 
xilinx@192.168.2.99's password: 
Welcome to Ubuntu 15.10 (GNU/Linux 3.17.0-xilinx armv7l)

 * Documentation:  https://help.ubuntu.com/
Last login: Thu Jan  1 01:33:59 1970 from 192.168.2.2
xilinx@pynq:~$ tar xvf hpca_semester_project.tar.gz -C jupyter_notebooks
```

Ignore warning messages which say 'time stamp X is Y s in the future'. This is occuring because clock settings between your host PC and the PYNQ board differ.

#### Step (5) Build and Install the Project on the PYNQ Board

From within the project's root directory, create a new sub-directory called 'build'. It will contain the build tree generated by cmake. Once cmake has been run, Makefiles will be automatically generated which can build and install all the nessessary components.

```
$ cd ~/jupyter_notebooks/hpca_semester_project
$ mkdir build
$ cd build
$ cmake ../
$ make install
```
The following files should now exist relative to the project's root directory:
* lib/libcbm.so
* module/pycbm.so

#### Step (5) Run an Example Notebook

To verify the project was built and intalled successfully, try running one of the example notebooks.

Using a web browser, navigate the the following URL: http://192.168.2.99:9090
The login information should be xilinx/xilinx (username and password).
Once logged onto Jupyter, navigate to the notebook located at hpca_semester_project/notebooks/measure_libcbm.ipynb

On the toolbar located near the top of the page, select the "run cell" button. You should see a graph appear displaying the execution time of functions within libcbm.so vs. buffer size.

### Building and Installing on a PC

From within the project's root directory, create a new sub-directory called 'build'. It will contain the build tree generated by cmake. Once cmake has been run, Makefiles will be automatically generated which can build and install all the nessessary components.

```
$ cd hpca_semester_project
$ mkdir build
$ cd build
$ cmake ../
$ make install
```

### Running Examples on a PC

To run examples, go to the 'examples' sub-directory.

```
$ python measure_libcbm.py
$ python test_libcbm.py
```